{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link}from'react-router-dom';import{toursAPI}from'../../services/api';import'./HotDeal.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const HotDeal=()=>{var _hotTour$images;const calculateTimeLeft=()=>{const targetDate=new Date();// Set target to tomorrow midnight for demo purposes\ntargetDate.setHours(24,0,0,0);const difference=+targetDate-+new Date();let timeLeft={};if(difference>0){timeLeft={hours:Math.floor(difference/(1000*60*60)%24),minutes:Math.floor(difference/1000/60%60),seconds:Math.floor(difference/1000%60)};}return timeLeft;};const[timeLeft,setTimeLeft]=useState(calculateTimeLeft());const[hotTour,setHotTour]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{const fetchHotTour=async()=>{try{const tours=await toursAPI.getAll('status=Active');// Find tour with highest discount\nconst discountedTours=tours.filter(t=>t.discountType!=='none');if(discountedTours.length>0){const best=discountedTours.reduce((prev,current)=>{const prevValue=prev.discountType==='percentage'?prev.discountValue:prev.discountValue/prev.priceAdult*100;const currValue=current.discountType==='percentage'?current.discountValue:current.discountValue/current.priceAdult*100;return currValue>prevValue?current:prev;});setHotTour(best);}}catch(err){console.error('Failed to fetch hot tour:',err);}finally{setLoading(false);}};fetchHotTour();},[]);useEffect(()=>{const timer=setTimeout(()=>{setTimeLeft(calculateTimeLeft());},1000);return()=>clearTimeout(timer);});if(loading||!hotTour)return null;const discountDisplay=hotTour.discountType==='percentage'?\"-\".concat(hotTour.discountValue,\"%\"):\"-$\".concat(hotTour.discountValue);const discountedPrice=hotTour.discountType==='percentage'?(hotTour.priceAdult*(1-hotTour.discountValue/100)).toFixed(0):hotTour.priceAdult-hotTour.discountValue;return/*#__PURE__*/_jsx(\"div\",{className:\"container-xxl py-5 hot-deal-section\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row g-5 align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-6 wow fadeInUp\",\"data-wow-delay\":\"0.1s\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"position-relative h-100 hot-deal-img-wrapper\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"img-fluid rounded w-100 h-100\",src:(_hotTour$images=hotTour.images)!==null&&_hotTour$images!==void 0&&_hotTour$images[0]?hotTour.images[0].startsWith('http')?hotTour.images[0]:\"http://localhost:5000\".concat(hotTour.images[0]):\"assets/img/package-3.jpg\",alt:hotTour.title,style:{objectFit:\"cover\",minHeight:'400px'}}),/*#__PURE__*/_jsxs(\"div\",{className:\"promo-badge\",children:[/*#__PURE__*/_jsx(\"span\",{children:discountDisplay}),/*#__PURE__*/_jsx(\"small\",{children:\"Chegirma\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-lg-6 wow fadeInUp\",\"data-wow-delay\":\"0.3s\",children:[/*#__PURE__*/_jsx(\"h6\",{className:\"section-title bg-white text-start text-danger pe-3\",children:\"QAYNOQ TAKLIF \\uD83D\\uDD25\"}),/*#__PURE__*/_jsx(\"h1\",{className:\"mb-4\",children:hotTour.title}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-4 text-justify\",children:hotTour.description||\"Faqat bugun! Ushbu ajoyib sayohat imkoniyatini qo'ldan boy bermang. Narx ichiga barcha xizmatlar kiritilgan.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"countdown-container mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"countdown-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"number\",children:timeLeft.hours||'00'}),/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Soat\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"countdown-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"number\",children:timeLeft.minutes||'00'}),/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Daqiqa\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"countdown-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"number\",children:timeLeft.seconds||'00'}),/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Soniya\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"price-tag mb-4\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"old-price\",children:[\"$\",hotTour.priceAdult]}),/*#__PURE__*/_jsxs(\"span\",{className:\"new-price text-primary\",children:[\"$\",discountedPrice]}),/*#__PURE__*/_jsx(\"small\",{className:\"ms-2\",children:\"/ kishi boshiga\"})]}),/*#__PURE__*/_jsx(Link,{to:\"/tour/\".concat(hotTour._id),className:\"btn btn-primary py-3 px-5 mt-2 rounded-pill shadow\",children:\"Hozir Band Qiling\"})]})]})})});};export default HotDeal;","map":{"version":3,"names":["React","useState","useEffect","Link","toursAPI","jsx","_jsx","jsxs","_jsxs","HotDeal","_hotTour$images","calculateTimeLeft","targetDate","Date","setHours","difference","timeLeft","hours","Math","floor","minutes","seconds","setTimeLeft","hotTour","setHotTour","loading","setLoading","fetchHotTour","tours","getAll","discountedTours","filter","t","discountType","length","best","reduce","prev","current","prevValue","discountValue","priceAdult","currValue","err","console","error","timer","setTimeout","clearTimeout","discountDisplay","concat","discountedPrice","toFixed","className","children","src","images","startsWith","alt","title","style","objectFit","minHeight","description","to","_id"],"sources":["/home/user/Desktop/code/demofront/frontend/src/components/HotDeal/HotDeal.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { toursAPI } from '../../services/api';\nimport './HotDeal.css';\n\nconst HotDeal = () => {\n    const calculateTimeLeft = () => {\n        const targetDate = new Date();\n        // Set target to tomorrow midnight for demo purposes\n        targetDate.setHours(24, 0, 0, 0);\n\n        const difference = +targetDate - +new Date();\n        let timeLeft = {};\n\n        if (difference > 0) {\n            timeLeft = {\n                hours: Math.floor((difference / (1000 * 60 * 60)) % 24),\n                minutes: Math.floor((difference / 1000 / 60) % 60),\n                seconds: Math.floor((difference / 1000) % 60),\n            };\n        }\n\n        return timeLeft;\n    };\n\n    const [timeLeft, setTimeLeft] = useState(calculateTimeLeft());\n    const [hotTour, setHotTour] = useState(null);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        const fetchHotTour = async () => {\n            try {\n                const tours = await toursAPI.getAll('status=Active');\n                // Find tour with highest discount\n                const discountedTours = tours.filter(t => t.discountType !== 'none');\n                if (discountedTours.length > 0) {\n                    const best = discountedTours.reduce((prev, current) => {\n                        const prevValue = prev.discountType === 'percentage' ? prev.discountValue : (prev.discountValue / prev.priceAdult * 100);\n                        const currValue = current.discountType === 'percentage' ? current.discountValue : (current.discountValue / current.priceAdult * 100);\n                        return (currValue > prevValue) ? current : prev;\n                    });\n                    setHotTour(best);\n                }\n            } catch (err) {\n                console.error('Failed to fetch hot tour:', err);\n            } finally {\n                setLoading(false);\n            }\n        };\n        fetchHotTour();\n    }, []);\n\n    useEffect(() => {\n        const timer = setTimeout(() => {\n            setTimeLeft(calculateTimeLeft());\n        }, 1000);\n\n        return () => clearTimeout(timer);\n    });\n\n    if (loading || !hotTour) return null;\n\n    const discountDisplay = hotTour.discountType === 'percentage'\n        ? `-${hotTour.discountValue}%`\n        : `-$${hotTour.discountValue}`;\n\n    const discountedPrice = hotTour.discountType === 'percentage'\n        ? (hotTour.priceAdult * (1 - hotTour.discountValue / 100)).toFixed(0)\n        : hotTour.priceAdult - hotTour.discountValue;\n\n    return (\n        <div className=\"container-xxl py-5 hot-deal-section\">\n            <div className=\"container\">\n                <div className=\"row g-5 align-items-center\">\n                    <div className=\"col-lg-6 wow fadeInUp\" data-wow-delay=\"0.1s\">\n                        <div className=\"position-relative h-100 hot-deal-img-wrapper\">\n                            <img\n                                className=\"img-fluid rounded w-100 h-100\"\n                                src={hotTour.images?.[0] ? (hotTour.images[0].startsWith('http') ? hotTour.images[0] : `http://localhost:5000${hotTour.images[0]}`) : \"assets/img/package-3.jpg\"}\n                                alt={hotTour.title}\n                                style={{ objectFit: \"cover\", minHeight: '400px' }}\n                            />\n                            <div className=\"promo-badge\">\n                                <span>{discountDisplay}</span>\n                                <small>Chegirma</small>\n                            </div>\n                        </div>\n                    </div>\n                    <div className=\"col-lg-6 wow fadeInUp\" data-wow-delay=\"0.3s\">\n                        <h6 className=\"section-title bg-white text-start text-danger pe-3\">\n                            QAYNOQ TAKLIF ðŸ”¥\n                        </h6>\n                        <h1 className=\"mb-4\">{hotTour.title}</h1>\n                        <p className=\"mb-4 text-justify\">\n                            {hotTour.description || \"Faqat bugun! Ushbu ajoyib sayohat imkoniyatini qo'ldan boy bermang. Narx ichiga barcha xizmatlar kiritilgan.\"}\n                        </p>\n\n                        <div className=\"countdown-container mb-4\">\n                            <div className=\"countdown-item\">\n                                <span className=\"number\">{timeLeft.hours || '00'}</span>\n                                <span className=\"label\">Soat</span>\n                            </div>\n                            <div className=\"countdown-item\">\n                                <span className=\"number\">{timeLeft.minutes || '00'}</span>\n                                <span className=\"label\">Daqiqa</span>\n                            </div>\n                            <div className=\"countdown-item\">\n                                <span className=\"number\">{timeLeft.seconds || '00'}</span>\n                                <span className=\"label\">Soniya</span>\n                            </div>\n                        </div>\n\n                        <div className=\"price-tag mb-4\">\n                            <span className=\"old-price\">${hotTour.priceAdult}</span>\n                            <span className=\"new-price text-primary\">${discountedPrice}</span>\n                            <small className=\"ms-2\">/ kishi boshiga</small>\n                        </div>\n\n                        <Link to={`/tour/${hotTour._id}`} className=\"btn btn-primary py-3 px-5 mt-2 rounded-pill shadow\">\n                            Hozir Band Qiling\n                        </Link>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default HotDeal;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}